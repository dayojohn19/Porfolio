{% extends "commerce/invest/layout.html" %}
{% load humanize %}
{% load static %}
{% block body %}

<link rel="stylesheet" href="{% static 'commerce/invest/table.css' %}">
<br><br>

<table>
    <tr>
        <th colspan="2">Investments</th>
    </tr>
    <tr>
        <th>Total Amount of Pesos</th>
        <th>Total Amount of Stocks</th>
    </tr>
    <tr>
        <td>{{investments.amount | intcomma}}</td>
        <td>{{investments.stock}}</td>
    </tr>
</table>



<hr>
<table>
    <tr>
        <th>ID</th>
        <th>Share Holder</th>
        <th>Contact</th>
        <th>Share Percentage</th>
        <th>Share Amount</th>
        <th>Date Invested</th>
        <th>Date ReInvested</th>
    </tr>
    {% for investor in investors %}
    <tr>
        <td>{{investor.id}}</td>
        <td>{{investor.investor_name}}</td>
        <td>{{investor.investor_contact}}</td>
        <td>{{investor.invested_percentage}} %</td>
        <td class="amount-table">{{investor.invested_amount | intcomma}}
            {% if request.user.is_superuser %}
            <button id="{{investor.id}}" onclick="getForm(id)">Change</button>
            <form method="post" action="{% url 'invest:reinvest' csrf_token %}" style="display: none;"
                class="form-{{investor.id}}">
                {% csrf_token %}
                <input type="number" placeholder="Amount to Change" name="amount" required>
                <input hidden readonly value="{{investor.id}}" name="investor_id" required>
                <input type="submit">
            </form>
            {% endif %}

        </td>
        <td>{{investor.timestamp}}</td>
        <td>{{investor.reinvested}}</td>
    </tr>

    {% endfor %}

</table>
<h2>Investment Reocrd</h2>
{% for records in invest_records %}
{{records.timestamp}}<br>
{{records.timestamp2}}<br>
{{records.investor_name}}<br>
{{records.invest_amount}}<br>
<hr>
{% endfor %}

<h2>Make Voting SYstem</h2>




<!-- FORM OF ADDING INVESTOR -->
{% if request.user.is_superuser %}
<form id="form" method="POST" action="{% url 'invest:add_investor' csrf_token %}">
    {% csrf_token %}
    <h2> Add Investor </h2>
    <!-- <input readonly name="investor_name" value="{{request.user.username}}"> -->
    <input name="investor_name" value="{{request.user.username}}">

    <!-- <select name="investor_name">
        <option value="a">a</option>
        <option value="b">b</option>
        <option value="c">c</option>
        <option value="d">d</option>
    </select> -->
    <input name="investment_amount" type="number" placeholder="Amount">
    <input name="contact" placeholder="Contact">
    <br>
    <button type="submit">Submit</button>
</form>

<script>
    function getForm(id) {
        console.log(id)
        form = document.querySelector(`.form-${id}`)
        if (form.style.display == 'block') {
            form.style.display = 'none'
        } else {
            form.style.display = 'block';

        }
        console.log('FORM: ', form)
    }
</script>
<style>
    .amount-table {
        width: 300px;
    }
</style>

{% endif %}

{% endblock %}